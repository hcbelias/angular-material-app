md-card(layout='column')
  form(name='queryForm' ng-submit='ctrl.searchData()' layout='row').md-padding
    md-input-container
      label(flex) Data Inicial
      md-datepicker(ng-model="ctrl.startDate" md-placeholder="Data Início" name="startDate" ng-disabled='ctrl.loading')                      
    md-input-container
      label(flex) Data Final
      md-datepicker(ng-model="ctrl.endDate" md-placeholder="Data Final" name="endDate" ng-disabled='ctrl.loading')    
    md-input-container
      md-select(placeholder='Escolha uma loja', ng-model='ctrl.store' required name='store' ng-disabled='ctrl.loading')
        md-option(ng-value='iterator' ng-repeat='iterator in ctrl.storeList' ng-selected='$index === 0') {{iterator.name}}
      div(ng-messages='queryForm.store.$error')
        div(ng-message='required') Campo obrigatório
    md-input-container
      label(flex) Percentual de Lucro Mín.
      input(ng-model='ctrl.profitPercentage' name='profitPercentage' ui-hide-group-sep ui-number-mask='2' ng-pattern="/^[0-9]+(\.[0-9]{2})?$/" step="0.01" ng-disabled='ctrl.loading')
    div(layout='column')
      md-button.md-raised.md-warn(type='submit' ng-disabled='ctrl.loading') Atualizar
      md-button.md-raised.md-accent(type='button' ng-click='ctrl.generateFile()' ng-disabled='ctrl.loading') Gerar CSV
  md-table-container(ng-if='ctrl.data && ctrl.data.length')
    table(md-table='')
      thead(md-head='')
        tr(md-row='')
          th(md-column='')
            span Nome
          th(md-column='')
            span Id
          th(md-column='')
            span Vol.
          th(md-column='') 
            span Vol. Fin.
          th(md-column='') 
            span Vol. Fin %
          th(md-column='') 
            span Vd. Tot.
          th(md-column='') 
            span Custo Tot.
          th(md-column='') 
            span Lucro
          th(md-column='') 
            span Dt. Estoque
          th(md-column='') 
            span Dt. Finalizado
      tbody(md-body='' )
        tr(md-row='', md-select='iterator', md-select-id='name', md-auto-select='', ng-repeat='iterator in ctrl.data | orderBy: "-finalizeDate"')
          td(md-cell='') {{iterator.name}}
          td(md-cell='') {{ iterator.kegId}}LJ{{("0" + ctrl.store.order).slice(-2)}} 
          td(md-cell='') {{iterator.volume}}
          td(md-cell='') {{iterator.remaining}}
          td(md-cell='') {{(iterator.remaining/iterator.volume * 100).toFixed(2)}}%
          td(md-cell='') R${{iterator.totalSale.toFixed(2) }} 
          td(md-cell='') R${{iterator.totalCost.toFixed(2) }}
          td(md-cell='') {{ iterator.profitPercentage ? iterator.profitPercentage.toFixed(2)+"%" : "S/V"}}
          td(md-cell='') {{iterator.createdAt | date: 'dd-MM-yy'}}
          td(md-cell='') {{iterator.finalizeDate | date: 'dd-MM-yy'}}

